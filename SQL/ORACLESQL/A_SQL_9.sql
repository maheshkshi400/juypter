
SELECT * FROM EMP;


SELECT EMPNO,ENAME,SAL,MGR,SYS_CONNECT_BY_PATH(ENAME,'-->')
FROM EMP
START WITH ENAME='KING'
CONNECT BY PRIOR EMPNO=MGR;


--GROUP SALARY

SELECT EMPNO,ENAME,SAL,MGR,
(
SELECT SUM(SAL)
FROM EMP
START WITH ENAME=A.ENAME
CONNECT BY PRIOR EMPNO=MGR) GROUP_SAL
FROM EMP A;


--BY USING FUNCTION


CREATE OR REPLACE FUNCTION GET_GROUP_SAL(
    PIN_ENAME VARCHAR
) RETURN NUMBER AS
    Iv_GRP_SAL NUMBER ;
BEGIN
    SELECT SUM(SAL) INTO Iv_GRP_SAL
    FROM EMP
    START WITH ENAME = PIN_ENAME
    CONNECT BY PRIOR EMPNO = MGR;

    RETURN Iv_GRP_SAL;
END;
/

SELECT EMPNO,
       ENAME,
       SAL,
       MGR,
       GET_GROUP_SAL(ENAME) AS GROUP_SAL
FROM EMP;











