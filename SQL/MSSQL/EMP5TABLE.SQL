
--USE DATABASE EMPLOEE

USE EMPLOYEE

-- CREATE TABLE EMP

CREATE TABLE EMP5 (
    EMPNO INT ,
    ENAME CHAR(20),
    JOB  CHAR(20),
    MGR INT,
    HIREDATE DATE,
    SAL MONEY,
    COMM INT,
    DEPTNO INT  
);


<<<<<<< HEAD
select emp,empname,dept,sal,mgrid,select max(sal) from emp where sal<5 and dept='HR';
=======
select ENAME,JOB,MGR,HIREDATE,MAX(SAL) from EMP5 aINNER JOIN EMP5 b ON a.EMPNO=b.EMPNO WHERE SAL=(SELECT MAX(SAL) FROM EMP5)

WITH EMP_CTE AS(
    SELECT TOP 1 SAL 
)
>>>>>>> 591731762cd9d3280aded8d5b3ca1797ecd3a1bf


-- VERIFY THE CREATED TABLE

SELECT * FROM EMP5;

SELECT * FROM DEPT1

-- DROP TABLE
DROP TABLE EMP5

--INSERT THE RECORDS IN EMP5 YABLE

INSERT INTO EMP5 VALUES(7369,'SMITH','CLERK',7902,'17-DEC-1980',800,NULL,20)
INSERT INTO EMP5 VALUES(7499,'ALLEN','SALESMAN',7698,'20-FEB-1981',1600,300,30)
INSERT INTO EMP5 VALUES(7521,'WARD','SALESMAN',7698,'22-FEB-1981',1250,500,30)

INSERT INTO EMP5 VALUES(7566,'JONES','MANAGER',7839,'02-APR-1981',2975,NULL,20)
INSERT INTO EMP5 VALUES(7654,'MARTIN','SALESMAN',7698,'28-SEP-1981',1250,1400,30)
INSERT INTO EMP5 VALUES(7698,'BLAKE','MANAGER',7839,'01-MAY-1981',2850,NULL,30)

INSERT INTO EMP5 VALUES(7782,'CLARK','MANAGER',7839,'09-JUN-1981',2450,NULL,10)
INSERT INTO EMP5 VALUES(7788,'SCOTT','ANALYST',7566,'19-APR-1987',3000,NULL,20)
INSERT INTO EMP5 VALUES(7839,'KING','PRESIDENT',NULL,'17-NOV-1981',5000,NULL,10)


INSERT INTO EMP5 VALUES(7844,'TURNER','SALESMAN',7698,'08-SEP-1981',1500,0,30)
INSERT INTO EMP5 VALUES(7876,'ADAMS','CLERK',7788,'23-MAY-1987',1100,NULL,20)
INSERT INTO EMP5 VALUES(7900,'JAMES','CLERK',7698,'03-DEC-1981',950,NULL,30)

INSERT INTO EMP5 VALUES(7902,'FORD','ANALYST',7566,'03-DEC-1981',3000,NULL,20)
INSERT INTO EMP5 VALUES(7934,'MILLER','CLERK',7782,'23-JAN-1982',1300,NULL,10)
INSERT INTO EMP5 VALUES(7782,'CLARK','MANAGER',7839,'09-JUN-1981',2450,NULL,10)



--CREATE TABLE DEPATEMENT

CREATE TABLE DEPT1(DEPTNO INT,DNAME CHAR(10),LOC CHAR(10),LOC_ID INT)

--VERFING THE CREATED TABLE DEPT1

SELECT * FROM DEPT1

-- INSERTING RECORDS IN DEPT TABLE

INSERT INTO DEPT1 VALUES(10,'ACCOUNTING','NEWYORK',122)
INSERT INTO DEPT1 VALUES(20,'RESEARCH','DALLAS',124)
INSERT INTO DEPT1 VALUES(30,'SALES','CHICAGO',123)
INSERT INTO DEPT1 VALUES(40,'OPERATIONS','BOSTON',167)

--CREATE TABLE SALGRADE

CREATE TABLE SALGRADE(GRADE INT,LOSAL INT,HISAL INT)

--VERFING THE CREATED TABLE

SELECT * FROM SALGRADE

--INSERTING RECORDS IN SALGRADE TABLE 

INSERT INTO SALGRADE VALUES(1,700,1200)
INSERT INTO SALGRADE VALUES(2,1201,1400)
INSERT INTO SALGRADE VALUES(3,1401,2000)
INSERT INTO SALGRADE VALUES(4,2001,3000)
INSERT INTO SALGRADE VALUES(5,3001,9999)



WITH FirstRecordCTE AS (
    SELECT *,
           ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS RowNum
    FROM EMP5),

LastRecordCTE AS (
    SELECT *,
           ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS RowNumDesc
    FROM EMP5
)
SELECT *
FROM FirstRecordCTE
WHERE RowNum = 1
UNION ALL
SELECT *
FROM LastRecordCTE
WHERE RowNumDesc = 1;



CREATE TABLE NEW_EMP
AS
SELECT * FROM EMP5 WHERE 1=2;


SELECT ENAME, REVERSE (ENAME) AS REVERSE_ENAME FROM EMP5;


SELECT DATENAME(day, '2021/09/10') AS Result1,  
DATENAME(month, '2021/09/10') AS Result2,  
DATENAME(year, '2021/09/10') AS Result3;  


CREATE TABLE testdate(  
 ColDTO DATETIMEOFFSET    
);    
INSERT INTO testdate    
VALUES ('2020-09-20 7:45:50.71345 -5:00'); 

SELECT SWITCHOFFSET(ColDTO, '-08:00') AS Result FROM testdate; 

SELECT ISDATE('2020-06-15') AS Result1,  
ISDATE('2020-15-06') AS Result2;   



--find out the same salary employees

SELECT * FROM EMP5 E1,EMP5 E2 
WHERE E1.SAL=E2.SAL 
AND E1.EMPNO != E2.EMPNO;





SELECT * FROM  dbo.EMP2

--find out the records having 2 times 'L' in his name

SELECT * FROM EMP2 WHERE ename LIKE'L%L%';
SELECT * FROM EMP2 WHERE LEN(ENAME)-LEN(REPLACE(ENAME,'L','')) >=2


--find out  the 2nd character of employee name is vowels

SELECT * FROM EMP2 WHERE 
ename LIKE '_A%' OR
ename LIKE '_E%' OR
ename LIKE '_I%' OR
ename LIKE '_O%' OR
ename LIKE '_U%';

--BY USING SUBSTRINGMETHOD

SELECT * FROM EMP2 WHERE SUBSTRING(ename,2,1) in ('a','e','i','o','u');


--
USE STUDENTS;
CREATE TABLE STUDENT1(NAME NVARCHAR(20),MARKS INT);

INSERT INTO STUDENT1 VALUES('MAHESH',90);
INSERT INTO STUDENT1 VALUES('GANESH',70);
INSERT INTO STUDENT1 VALUES('SHREYA',80);
INSERT INTO STUDENT1 VALUES('HEMAVATI',90);
INSERT INTO STUDENT1 VALUES('RAKESH',NULL);


SELECT COUNT(*) FROM dbo.STUDENT1;
SELECT COUNT(1) FROM dbo.STUDENT1;
SELECT COUNT(MARKS) FROM dbo.STUDENT1;
SELECT sum(MARKS) FROM dbo.STUDENT1;
SELECT AVG(MARKS) FROM dbo.STUDENT1;

SELECT TOP 1 MARKS FROM dbo.STUDENT1;




SELECT * /*This is the outer query part */
FROM EMP5 E1
WHERE (N-1) = ( /* Subquery starts here */
SELECT COUNT(DISTINCT SAL))
FROM EMP5 E2
WHERE E1.SAL > E2.SAL)


SELECT * 
FROM EMP5 E1
WHERE (
    N - 1
) = (
    SELECT COUNT(DISTINCT SAL)
    FROM EMP5 E2
    WHERE E2.SAL > E1.SAL
);




--NTH SAL 
SELECT ENAME,SAL from EMP5 e1 where 

2-1 = (SELECT COUNT(DISTINCT SAL)from EMP5 e2 where e2.SAL > e1.SAL);



