USE SALES

CREATE TABLE SALES3(ID INT,PRODUCT VARCHAR(20),SALES_YEAR INT,QUANTITY_SOLD INT) 

INSERT INTO SALES3 Values(1,'LAPTOP',1998,2500);
INSERT INTO SALES3 Values(2,'LAPTOP',1999,3600);
INSERT INTO SALES3 Values(3,'LAPTOP',2000,4200);
INSERT INTO SALES3 Values(4,'KEYBORAD',1998,2300);
INSERT INTO SALES3 Values(5,'KEYBORAD',1999,4800);
INSERT INTO SALES3 Values(6,'KEYBORAD',2000,5000);
INSERT INTO SALES3 Values(7,'MOUSE',1998,6000);
INSERT INTO SALES3 Values(8,'MOUSE',1999,3400);
INSERT INTO SALES3 Values(9,'MOUSE',2000,4600);


--WRITE SQL QUERY TO GET THE TOTALSALES IN YEAR 1998,1999 AND 2000 FOR ALL THE PRODUCT AS SHOWN BELOW

--UING PIVOT TABLE


SELECT 'TotalSales' AS TOTAL_SALES,[1998],[1999],[2000]
FROM
(
    SELECT SALES_YEAR,QUANTITY_SOLD FROM SALES3
)P
PIVOT(
    SUM(QUANTITY_SOLD) FOR
    SALES_YEAR IN ([1998],[1999],[2000])
) AS PIVOT_TABLE



-- USING CASE STATEMENT


SELECT 'TotalSales' AS TOTAL_SALES,SUM([1998])AS '1998',SUM([1999])AS '1999',SUM([2000])AS '2000'
FROM(
    SELECT 
    CASE WHEN SALES_YEAR='1998' THEN SUM(QUANTITY_SOLD) END AS '1998',
    CASE WHEN SALES_YEAR='1999' THEN SUM(QUANTITY_SOLD) END AS '1999',
    CASE WHEN SALES_YEAR='2000' THEN SUM(QUANTITY_SOLD) END AS '2000'
    FROM SALES3
    GROUP BY SALES_YEAR
) t



