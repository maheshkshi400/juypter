--WRITE A QUERY TO DISPALY SALRY AFTER DECIMAL POINT ONLY

CREATE TABLE SALARY (
    ID INT,
    SALARY NUMBER(10, 4)
);

INSERT INTO SALARY(ID,SALARY) VALUES(1,3131.363);
INSERT INTO SALARY(ID,SALARY) VALUES(2,250.1659);
INSERT INTO SALARY(ID,SALARY) VALUES(3,950.659);
INSERT INTO SALARY(ID,SALARY) VALUES(4,9230.59);

SELECT * FROM SALARY;

SELECT SALARY,SUBSTR(SALARY,INSTR(SALARY,'.')+1) AS DEC FROM SALARY;

--WRITE A QUERY TO DISPLAY 2 DIGITS OF SALARY FROM ABOVE QUERY

SELECT SUBSTR(DEC,0,2) 
FROM (
SELECT SALARY,SUBSTR(SALARY,0,INSTR(SALARY,'.')-1) AS DEC FROM SALARY
);


--WRITE A QUERY TO DISPLAY VAID PHONE NUMBER AND LENGTH OF THE PHONE NUMBER  IS EQUAL TO 10

CREATE TABLE PHONE_NUMBER(PHONE_TYPE VARCHAR2(50),PHONE_NUMBER VARCHAR2(20));


INSERT INTO PHONE_NUMBER (PHONE_TYPE,PHONE_NUMBER) VALUES('HANDER',9860547890);
INSERT INTO PHONE_NUMBER (PHONE_TYPE,PHONE_NUMBER) VALUES('LANDLINE','7890547ABC');
INSERT INTO PHONE_NUMBER (PHONE_TYPE,PHONE_NUMBER) VALUES('MOBILE','9860547890567FG');
INSERT INTO PHONE_NUMBER (PHONE_TYPE,PHONE_NUMBER) VALUES('TELE',1234567890);
INSERT INTO PHONE_NUMBER (PHONE_TYPE,PHONE_NUMBER) VALUES('TWELVE','98605JKL890');

SELECT * FROM PHONE_NUMBER;



CREATE TABLE SALARY1(EMP_ID INT,SALARY INT);

INSERT INTO SALARY1 (EMP_ID,SALARY) VALUES(1,10000);
INSERT INTO SALARY1 (EMP_ID,SALARY) VALUES(2,7000);
INSERT INTO SALARY1 (EMP_ID,SALARY) VALUES(3,6000);
INSERT INTO SALARY1 (EMP_ID,SALARY) VALUES(4,5000);
INSERT INTO SALARY1 (EMP_ID,SALARY) VALUES(5,4000);
INSERT INTO SALARY1 (EMP_ID,SALARY) VALUES(6,80000);
INSERT INTO SALARY1 (EMP_ID,SALARY) VALUES(7,10000);

SELECT * FROM SALARY1;
DROP TABLE SALARY1;

SELECT SUM(SAL) AS SUM 
FROM (
SELECT SALARY,RTRIM(SALARY,0) AS SAL
FROM SALARY1;



DESCRIBE EMP;




SELECT * FROM EMP2;
SELECT * FROM DEPT;


SELECT E.ENAME, E.DEPTNO, E.SAL
FROM EMP2 E
INNER JOIN (
    SELECT DEPTNO, MAX(SAL) AS MAX_SAL
    FROM EMP2
    GROUP BY DEPTNO
) AS MAX_SALARIES ON E.DEPTNO = MAX_SALARIES.DEPTNO AND E.SAL = MAX_SALARIES.MAX_SAL;
